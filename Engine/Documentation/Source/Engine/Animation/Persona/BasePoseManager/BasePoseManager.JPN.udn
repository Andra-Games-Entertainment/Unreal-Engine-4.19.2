INTSourceChangelist:3209790
Availability:Public
Title:リターゲット マネージャ
Crumbs: %ROOT%, Engine, Engine/Animation, Engine/Animation/Persona
Description:スケルトン エディタ内のリターゲット マネージャ オプションの内容について説明します。
version:4.14
related:Engine\Animation\AnimationRetargeting
related:Engine/Animation/Skeleton

[VAR:Topic]
[OBJECT:Topic]
	[PARAM:image]
		![%Engine/Animation/Persona/AssetBrowser:title%](Engine/Animation/animation_topic.png)
	[/PARAM]
	[PARAM:icon]
		![](%ROOT%/content_icon.png)(convert:false)
	[/PARAM]
	[PARAM:title]
		%Engine/Animation/Persona/BasePoseManager:title%
	[/PARAM]
	[PARAM:description]
		%Engine/Animation/Persona/BasePoseManager:description%
	[/PARAM]
	[PARAM:path]
		[RELATIVE:Engine/Animation/Persona/BasePoseManager]
	[/PARAM]
[/OBJECT]
[/VAR]

**スケルトン エディタ** 内の **リターゲット マネージャ** では、リターゲット ソースの管理、リグの設定、同じ [スケルトン](Engine/Animation/Skeleton) アセットを共有しないキャラクターの [アニメーションのリターゲット](Engine\Animation\AnimHowTo\Retargeting) で使用するためのリターゲットのベース ポーズを定義します。スケルトン エディタのツールバーからリターゲット マネージャを開くことができます。 

[TOC(start:2 end:2)]


## リターゲット ソースの管理

リターゲットではスケルトン アセットを使用し、そのスケルトンに対して作成されたスケルタルメッシュによって定義されたオリジナルの比率を持ちます。そのため、ほとんどの場合、一方向のリターゲットはスムーズに機能します。ただし、その変更版のためだけに特別なアニメーションをビルドする場合がよくあります。 
例えば、同じスケルトン アセットを共有する複数のキャラクターがあるとします (ベース キャラクター、背の低いキャラクター、背の高いキャラクターなど)。ここでは、背の高いキャラクターに対して特別なアニメーションを作成したとします。

新規に作成したこの「背が高い版限定」アニメーションをインポートする場合でも、ベースとなるキャラクターから作成された元のものと同じ Skeleton アセットを使用する必要があります。これにより、新規アニメーションの比率に歪みが生じます。 
この解決策としては、**[Retarget Manager]** 内の **[Manage Retarget Source (リターゲットのソース管理)]** オプションを使います。これにより、アニメーション シーケンスをそのためにデザインした実際のスケルタル メッシュに関連付けることができます。こうすることで、特別なアニメーションのリターゲットで発生する問題が解消されます。

**[Manage Retarget Source]** は、比率を指定するために使うスケルタル メッシュのリストだと考えてみてください。リターゲットしたスケルタル メッシュに特別なアニメーションが必要な場合は、そのメッシュがリターゲット ソースとしてリスト化されていることを確認する必要があります。以下はその手順です。 

1. **スケルトン エディタ** 内の **ツールバー** から **[Retarget Source Manager]** ボタンをクリックします。 

	![](RetargetManager.png)

1. **[Add New Retarget Source (新規のリターゲットソースを追加)]** ボタンをクリックします。 

	![](AddSource.png)

1. 特別なアニメーションを作成したスケルタル メッシュを選びます。

	![](SelectSkeletalMesh.png)

	 **[Retarget Manager]** にスケルタル メッシュがリスト化されているのがわかります。

	![](Created.png)

1. 特定のスケルタルメッシュ用の特別なアニメーション シーケンスを開きます。 

1. **[Asset Details (アセットの詳細)]** パネルで、 **[アニメーション]** カテゴリ、そして **[Retarget Source]** プロパティの順に見て、ドロップダウン メニューからスケルタルメッシュを選択します。

	![](DropDownSelection.png)

	 メッシュを選択すると、その比率を使用してアニメーションを操作することを指定することになります。


## リグのセットアップ

![](SetUpRig.png)

Retarget Manager の真ん中のセクションでは、スケルトンに **リグ** を割り当ててアニメーション データを同じリグを使う別のスケルトンに渡すことができます。 
このプロセスは異なるスケルトン アセットを使うキャラクターのアニメーションのリターゲットを行うために必要です。 
**[Select Rig]** ドロップダウン オプションから使用するリグを選択することができます。このオプションにある **Humanoid** はほとんどのキャラクターで選択できます (エンジンの将来のアップデートでは、リグ作成機能を含む可能性があります)。 

![](HumanoidRig.png)

Humanoid Rig を割り当てたら、リグのノードと同じ (または類似) 位置に対応するスケルトンのボーンを割り当てる必要があります。 
ノードのドロップダウン メニューで、スケルトンから対応するボーンを手動で割り当てるか、メニュー上部にある **[Auto Mapping]** 機能を使用することができます。 
これにより、スケルトンを調べて、リグの各ノードに対して最適にマッチするボーンを探そうとします。 

**[Clear Mapping]** ボタンを使うと、現在割り当てられているすべてのボーンが対応するノード割り当てからワイプされます。**[Show Advanced]** ボタンは、指、IK ボーン、Twist Bone などのノード / ボーンの相関関係を追加で割り当てることができます。 
ソース スケルトンのリグ (または別のキャラクターにリターゲットするアニメーションを操作する Skeleton アセット) を設定したら、ターゲット スケルトンのスケルトンに進んで、同じリグを割り当て、リグ上のノードと最適にマッチするボーンを新しいスケルトンで定義する必要があります。 

[REGION:note]
別のスケルトンを使用するキャラクター間でアニメーションをリターゲットするためのリグ設定に関する操作ガイドについては、[](Engine\Animation\AnimHowTo\Retargeting) をご覧ください。
[/REGION]




## リターゲットのベース ポーズの管理

ソース スケルトンと正確には同じ基本ポーズを使用していないスケルトンにアニメーションをリターゲットする場合があるかもしれません。 

例えば、アニメーションをリターゲットする場合、以下の右側の画像のスケルトンをご覧ください。  

![](ManageBasePose1.png)(w:840)

左側のソース スケルトンは、A-Pose であり、ターゲット スケルトンは、T-Pose を使用しています。アニメーションを現在の状態のままリターゲットする場合、以下のような問題が生じることがあります。 

![](TargetAnimation.png)(w:540)![](BadBasePose.png)(w:550)

上の図ではショットガンを持っているキャラクターの横にターゲット アニメーションがあります。しかし、右側の新しいキャラクターにアニメーションをリターゲットする場合、(この 2 つは異なるベース ポーズを使用しているため) アームの位置決めが正しくありません。 
これは **Retarget Manager** 内でベース ポーズをリターゲットすることで修正することができます。こうすることで、キャラクターの通常のベース ポーズを使用するのではなく、リターゲットしたベースポーズをアニメーションのリターゲット目的で使用することができます。 

キャラクターのボーンを選択し回転させて (この場合、左右の肩)、キャラクターを A-Pose にして **Save Pose** をクリックすることができます。 

![](RetargetedBasePose.png)

アニメーションのリターゲットに進むと、リターゲットされたベースポーズが更新されているのがわかります。 

![](NewBasePose.png)(w:840)

さらに多くの類似のベース ポーズを持つスケルトンのアニメーションをリターゲットすると、リターゲットしたアニメーションの結果の見た目がよくなります。 

![](HoldingShotGun.png)